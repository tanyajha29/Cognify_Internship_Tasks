<!doctype html><html><head><meta charset="utf-8"><title>Login</title><link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/material.css"></head><body>
<nav class="blue darken-2"><div class="nav-wrapper container"><a href="/" class="brand-logo">TaskFlow</a></div></nav>
<main class="container"><div class="card form-card hoverable"><div class="card-content"><h5>Login</h5>
<form id="loginForm">
  <div class="input-field"><input id="usernameOrEmail" name="usernameOrEmail" type="text"><label for="usernameOrEmail">Username or Email</label></div>
  <div class="input-field"><input id="password" name="password" type="password"><label for="password">Password</label></div>
  <button class="btn" type="submit">Login</button>
</form>
</div></div></main>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script src="/js/tasks-api.js"></script>
<script>
document.getElementById('loginForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  try{
    const data = await ApiClient.login(document.getElementById('usernameOrEmail').value.trim(), document.getElementById('password').value);
    M.toast({html:'Logged in', classes:'green lighten-1'});
    setTimeout(()=> location.href = '/tasks', 500);
  }catch(err){
    const msg = err.error || (err.errors?Object.values(err.errors).join(', '): 'Login failed');
    M.toast({html: msg, classes: 'red lighten-1'});
  }
});
</script>
</body></html>
