<!doctype html><html><head><meta charset="utf-8"><title>Register</title><link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/material.css"></head><body>
<nav class="blue darken-2"><div class="nav-wrapper container"><a href="/" class="brand-logo">TaskFlow</a></div></nav>
<main class="container"><div class="card form-card hoverable"><div class="card-content"><h5>Create an account</h5>
<form id="registerForm">
  <div class="input-field"><input id="fullname" name="fullname" type="text"><label for="fullname">Full Name</label></div>
  <div class="input-field"><input id="username" name="username" type="text"><label for="username">Username</label></div>
  <div class="input-field"><input id="email" name="email" type="email"><label for="email">Email</label></div>
  <div class="input-field"><input id="password" type="password" name="password"><label for="password">Password</label></div>
  <div class="input-field"><input id="confirm_password" type="password" name="confirm_password"><label for="confirm_password">Confirm Password</label></div>
  <button id="regBtn" class="btn">Register</button>
</form>
</div></div></main>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script src="/js/tasks-api.js"></script>
<script>
document.getElementById('registerForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const payload = {
    fullname: document.getElementById('fullname').value.trim(),
    username: document.getElementById('username').value.trim(),
    email: document.getElementById('email').value.trim(),
    password: document.getElementById('password').value,
    confirm_password: document.getElementById('confirm_password').value
  };
  try {
    const res = await ApiClient.register(payload);
    M.toast({html: 'Registered! Please login', classes: 'green lighten-1'});
    setTimeout(()=> location.href = '/login', 900);
  } catch (err) {
    const msg = err.errors ? Object.values(err.errors).join(', ') : (err.error || 'Register failed');
    M.toast({html: msg, classes: 'red lighten-1'});
  }
});
</script>
</body></html>
